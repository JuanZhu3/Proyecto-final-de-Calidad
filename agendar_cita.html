<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Agendar Cita</title>
  <link rel="stylesheet" href="estilos.css" />
</head>
<body>
  <div class="sidebar">
    <div class="sidebar-header">
      <span class="avatar">üóìÔ∏è</span>
      <h3>Campus Connect</h3>
    </div>
    <ul>
      <li><a href="menu_principal.html">Inicio</a></li>
      <li><a href="cita.html">Citas</a></li>
      <li><a href="prestamo_libro.html">Pr√©stamos</a></li>
      <li><a href="cuenta.html">Cuenta</a></li>
      <li><a href="atencion_cliente.html">Atenci√≥n al Cliente</a></li>
    </ul>
  </div>
  <div class="main">
    <div class="topbar">
      <span>CAMPUS CONNECT UTP</span>
      <span>ESTUDIANTE ‚ñº</span>
    </div>
    <div class="content">
      <div class="card">
        <h2>Agendar una Cita</h2>

        <div class="form-group">
          <label for="tipoCita">Tipo de Cita:</label>
          <select id="tipoCita" required>
            <option value="">Selecciona una opci√≥n</option>
            <option value="psicologia">Psicolog√≠a</option>
            <option value="becas">Becas</option>
            <option value="consejeria">Consejer√≠a Acad√©mica</option>
          </select>
        </div>

        <div class="form-group">
          <label for="fecha">Fecha:</label>
          <input type="date" id="fecha" required />
          <div id="errorFecha" class="error-msg">No se permite seleccionar fines de semana ni d√≠as pasados.</div>
        </div>

        <div class="form-group">
          <label for="hora">Hora:</label>
          <input type="time" id="hora" required disabled />
        </div>

        <button id="btnConfirmar" disabled>Confirmar Cita</button>
        <div id="resumenCita" class="resumen-cita"></div>
      </div>
    </div>
  </div>

  <script>
    const fecha = document.getElementById("fecha");
    const hora = document.getElementById("hora");
    const tipoCita = document.getElementById("tipoCita");
    const btn = document.getElementById("btnConfirmar");
    const errorFecha = document.getElementById("errorFecha");
    const resumen = document.getElementById("resumenCita");

    const hoy = new Date().toISOString().split("T")[0];
    fecha.setAttribute("min", hoy);

    fecha.addEventListener("click", () => fecha.showPicker && fecha.showPicker());
    hora.addEventListener("click", () => hora.showPicker && hora.showPicker());

    fecha.addEventListener("change", () => {
      const seleccionada = new Date(fecha.value);
      const dia = seleccionada.getDay();
      if (dia === 0 || dia === 6 || seleccionada < new Date(hoy)) {
        errorFecha.classList.add("error-visible");
        hora.disabled = true;
        btn.disabled = true;
      } else {
        errorFecha.classList.remove("error-visible");
        hora.disabled = false;
        validarCampos();
      }
    });

    tipoCita.addEventListener("change", validarCampos);
    hora.addEventListener("input", validarCampos);

    function validarCampos() {
      btn.disabled = !(tipoCita.value && fecha.value && hora.value && !hora.disabled);
    }

    btn.addEventListener("click", () => {
      const resumenTexto = `‚úÖ Has agendado una cita de <strong>${tipoCita.options[tipoCita.selectedIndex].text}</strong> el <strong>${fecha.value}</strong> a las <strong>${hora.value}</strong>.`;
      resumen.innerHTML = resumenTexto;
      resumen.style.display = "block";
    });
  </script>
</body>
</html>
